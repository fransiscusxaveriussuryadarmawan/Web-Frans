<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tonton Video untuk Mendapatkan Link Team</title>
    <script src="https://www.youtube.com/iframe_api"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            padding: 20px;
        }

        #player {
            margin: 20px auto;
            width: 640px;
            height: 360px;
        }

        #status {
            font-size: 18px;
            margin: 20px 0;
            color: #333;
        }

        #getLinkButton {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: none;
        }

        #getLinkButton:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
    </style>
</head>

<body>
    <h1>Tonton Video untuk Mendapatkan Link Team</h1>
    <div id="player"></div>
    <div id="status">Tonton video ini selama 3 menit untuk membuka link team premium.</div>
    <button id="getLinkButton" disabled>Ambil Link Team</button>

    <script>
        let player;
        let watchedTime = 0; // Waktu yang telah ditonton (dalam detik)
        const requiredTime = 60; // Durasi yang harus ditonton (3 menit)
        const videoId = "Ou6r01rWWBA"; // Ganti dengan ID video Anda

        // Inisialisasi YouTube Player
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '360',
                width: '640',
                videoId: videoId,
                events: {
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                trackWatchTime();
            }
        }

        // Fungsi untuk melacak waktu tonton
        function trackWatchTime() {
            const interval = setInterval(() => {
                if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                    watchedTime++;
                    console.log(`Waktu ditonton: ${watchedTime} detik`);

                    // Jika waktu tonton memenuhi syarat
                    if (watchedTime >= requiredTime) {
                        clearInterval(interval);
                        document.getElementById("status").textContent = "Selamat! Anda telah memenuhi syarat.";
                        document.getElementById("getLinkButton").style.display = "inline-block";
                        document.getElementById("getLinkButton").disabled = false;
                    }
                } else {
                    clearInterval(interval);
                }
            }, 1000);
        }

        // Fungsi untuk mengakses link team
        document.getElementById("getLinkButton").addEventListener("click", () => {
            window.location.href = `validate_watch.php?watched_time=${watchedTime}&video_id=${videoId}`;
        });
    </script>
</body>

</html>